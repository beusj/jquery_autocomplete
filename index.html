<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>jQuery UI Autocomplete - Remote datasource</title>
  <link rel="stylesheet" href="https://code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">
  
<!--   <link rel="stylesheet" href="/resources/demos/style.css">
  <style>
  .ui-autocomplete-loading {
    background: white url("images/ui-anim_basic_16x16.gif") right center no-repeat;
  
  </style> -->

  
  <script src="https://code.jquery.com/jquery-1.12.4.js"></script>
  <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>
  <script>

  $( function() {

    // function log( message ) {
    //   $( "<div>" ).text( message ).prependTo( "#log" );
    //   $( "#log" ).scrollTop( 0 );
    // }
      function parseData(data) {
        if (!data) return null;
        var parsed = [];
        var rows = data.split("~!~");
        for (var i=0; i < rows.length; i++) {
          var row = $.trim(rows[i]);
          if (row) {
            consolte.log(parsed);
            parsed[parsed.length] = row.split("|")[5];
          }
        }
        return parsed;
      };

    // function split(val) {
    //   return val.split( /,\s*/ );
    // }

    // function extractLast(term) {
    //   return split(term).pop();
    // }

      // .on("keydown",function(event) {
      // if(event.keyCode === $.ui.keyCode.TAB &&
      //    $(this).autocomplete("instance").menu.active){
      //   event.preventDefault();
      //   }
      // }
      // )
    $( "#log" ).autocomplete(
        function(request,response) {
          $.getJSON("https://bioportal.bioontology.org/search/json_search/?q=" + encodeURI(request.term) + "&ontologies=SNOMEDCT&response=json&callback=?"),
        //   $.getJSON({
        //     url: "https://bioportal.bioontology.org/search/json_search/",
        //     data: {
        //       q: (request.term),
        //       ontologies: "SNOMEDCT",
        //       format: "jsonp"
        //     }
        //     // dataType: 'jsonp'
        //   }
        //   )
        // },
          function(data) {
            data = parseData(data.data)
            console.log(data);
            response(data);
          }
      }
      )
//error handling (i.e. success function)
      // minLength: 3,
      // search: function() {
      //   console.log(this.value);
      //   var q = extractLast(this.value);
      //   if(q.length < 2) {
      //     return false;
      //   }
      // },
//       focus: function() {
//         return false
//       },
//       select: function( event, ui ) {
//         var terms = split(this.value);
//         terms.pop();
//         terms.push(ui.item.value);
//         terms.push("");
//         this.value = terms.join(", ");
//         return false;
// //        log( "Selected: " + ui.item.value + " aka " + ui.item.id );
//       }
    });
  // });
  </script>
</head>
<body>

<div>
  Test Autocomplete:
  <div contenteditable="true" id='log' class="ui-widget-content">
  </div>
</div>
 
<!-- <div class="ui-widget">
  <label for="birds">Birds: </label>
  <input id="birds">
</div>
 
<div class="ui-widget" style="margin-top:2em; font-family:Arial">
  Result:
  <div id="log" style="height: 200px; width: 300px; overflow: auto;" class="ui-widget-content"></div>
</div> -->
 
 
</body>
</html>